<!doctype html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Video Player</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+Mono+TC&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
  <style type="text/css">
    html::-webkit-scrollbar {
      display: none;
      font-family: Arial;
      font-size: medium;
    }

    .roboto {
      font-family: "Roboto", sans-serif;
      font-optical-sizing: auto;
      font-weight: 240;
      font-style: normal;
      font-size: small;
      letter-spacing: 1px;
    }

    .lxgw {
      font-family: "LXGW WenKai Mono TC", monospace;
      font-weight: 400;
      font-style: normal;
    }

    .videoCard:hover {
      border: groove 2px;
      cursor: pointer;
    }

    .videoCard[data-selected="1"] {
      border: double teal 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="row mt-3">
      <div class="col-md-8 px-1">
        <div id="help_box" class="p-1 border-end border-1">
          <h1 class="display-6 text-center">Welcome!</h1>
          <div>
            <p>
              First click the button below to get the sample playlist file. 'Playlist.xlsx' will be saved on the desktop.
            </p>
            <p>
              Add rows to the excel file in the same manner as in the sample. DO NOT change or delete the header row.
            </p>
            <p>
              IMPORTANT: hours, minutes and seconds of a video MUST be entered correctly for an accurate estimate of the playtime.
            </p>
          </div>
          <div class="my-3">
            <button type="button" class="btn btn-primary" onclick="javascript: window.chrome.webview.postMessage('excel')">Sample Excel Playlist File</button>
          </div>
          <div>
            <p>
              After you have added your videos to the excel sheet, use the button on the right to browse open the playlist. If everything goes right, the videos will appear in the lists. Links can be temporarily added through the form "Add a quick link" also.
            </p>
          </div>
        </div>
        <div hidden id="player_box" class="ratio ratio-16x9 mt-3">
          <div id="_player"></div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="mt-3">
          <div class="btn-toolbar justify-content-center" role="toolbar">
            <div class="btn-group-lg me-2" role="group">
              <button hidden onclick="javascript: onErrorOrEnd(event);" id="btn_skip_next" type="button" class="btn  btn-secondary"><i class="bi bi-skip-forward-fill"></i></button>
              <button type="button" class="btn btn-secondary" onclick="javascript: window.chrome.webview.postMessage('win_min')"><i class="bi bi-arrow-down"></i></button>
              <button type="button" class="btn btn-secondary" onclick="javascript: window.chrome.webview.postMessage('win_restore')"><i class="bi bi-copy"></i></button>
              <button type="button" class="btn  btn-secondary" onclick="javascript: window.chrome.webview.postMessage('win_close')"><i class="bi bi-x-lg"></i></button>
            </div>
          </div>
        </div>
        <div class="text-center my-3">
          <button type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" class="btn btn-success display-3 rounded-circle btn-lg border-secondary border-5"><i class="bi bi-music-note-list"></i> <i class="bi bi-arrow-bar-right"></i> <span class="font-monospace small d-block" id="pending_duration"></span></button>
        </div>
        <div class="my-3">
          <label for="formFile" class="form-label"><i class="bi bi-music-player-fill"></i> Open Playlist Excel&nbsp;<a id="close_file_btn" hidden  class="link-offset-3" href="javascript:void(0)" onclick="javascript: close_file(this);">Clear&nbsp;list</a></label>
          <input class="form-control" type="file" id="excelFileInput" accept=".xlsx, .xls">
        </div>
        <div class="form-check form-switch mb-3">
          <input id="chk_shut_on_exit" class="form-check-input me-3" style="transform: scale(1.25); cursor: pointer" type="checkbox" onclick="javascript: window.chrome.webview.postMessage(`shut_${this.checked ? 'y' : 'n'}`)" />
          <label class="form-check-label small" for="switchCheckDefault">Shutdown&nbsp;PC&nbsp;on&nbsp;Play&nbsp;Stop</label>
        </div>
        <div class="form-check form-switch mb-3">
          <input id="chk_close_on_play_stop" class="form-check-input me-3" style="transform: scale(1.25); cursor: pointer" type="checkbox" />
          <label class="form-check-label small" for="switchCheckDefault">Close&nbsp;on&nbsp;Play&nbsp;Stop</label>
        </div>
        <div class="hstack gap-1">
          <div class="form-check form-switch">
            <input id="chk_force_exit" class="form-check-input me-3" style="transform: scale(1.25); cursor: pointer" type="checkbox" />
            <label class="form-check-label small" id="lbl_for_chk_force_exit" for="switchCheckDefault">Max&nbsp;Play&nbsp;mins&rarr;</label>
          </div>
          <div><input class="form-control small" type="number" value="2" min="2" max="90" step="1" id="exit_time" /></div>
        </div>
        <div class="mt-1">
          <i class="bi bi-clock"></i> <span class="font-monospace small" id="sp_current_time"></span>
        </div>
        <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight">
          <div class="offcanvas-header">
            <div class="vstack gap-3 text-center py-2">
              <div>
                <h5>
                  Playlist Queue
                </h5>
              </div>
              <div><button hidden id="btn_add_random_videos" onclick="javascript: add_random_videos_to_pl_global(this);" class="btn btn-secondary w-75 mx-auto">Add Random Videos</button></div>
              <div><button hidden id="btn_clear_playlist" onclick="javascript: clear_playlist_global();" class="btn btn-secondary  w-75 mx-auto">Clear Playlist</button></div>
            </div>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
          </div>
          <div class="offcanvas-body py-0">
            <ul class="list-group list-group-flush" id="play_list"></ul>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="row row-cols-1 g-2" id="vid_list"></div>
    </div>
    <div class="row my-5 py-2">
      <h1 class="display-6">Add a quick link</h1>
      <form id="frm_add_quick_link">
        <div class="my-3">
          <label class="form-label">Youtube Link</label>
          <input class="form-control" type="url" name="url" placeholder="https://www.youtube.com/..." autocomplete="off" pattern="https://.*" required />
        </div>
        <div class="mb-3">
          <label class="form-label">Video Title (optional)</label>
          <input class="form-control" type="text" name="title" autocomplete="off" />
        </div>
        <div>
          <small>(zero duration will be assumed 30 seconds)</small>
        </div>
        <div class="time-picker row mb-3">
          <div class="col">
            <label for="hours">Hours:</label>
            <select class="form-select" name="hours" id="hours"></select>
          </div>
          <div class="col">
            <label for="minutes">Minutes:</label>
            <select class="form-select" name="minutes" id="minutes"></select>
          </div>
          <div class="col">
            <label for="seconds">Seconds:</label>
            <select class="form-select" name="seconds" id="seconds"></select>
          </div>
        </div>

        <div class="mb-3">
          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" checked id="saveToFavorites">
            <label class="form-check-label" for="checkChecked">
              this link persists across future sessions
            </label>
          </div>
          <input class="btn btn-primary" type="submit" value="Add this Link">
        </div>
      </form>
      <div class="mt-5">
        <hr class="w-25" />
        <div class="form-check form-switch">
          <input id="chk_change_theme" class="form-check-input me-3" style="transform: scale(1.25); cursor: pointer" checked type="checkbox" />
          <label class="form-check-label" for="switchCheckDefault">Use dark theme</label>
        </div>
      </div>
      <div class="mt-3">
        <div class="form-check form-switch">
          <input id="chk_play_on_selection" class="form-check-input me-3" style="transform: scale(1.25); cursor: pointer" type="checkbox" />
          <label class="form-check-label" for="switchCheckDefault">Play starts on first selection</label>
        </div>
        <div class="my-3">
          <label for="range_pl_columns" class="form-label">Playlist Columns &rarr; </label>
          <output for="range_pl_columns" id="pl_columns"></output>
          <input type="range" class="form-range w-50 d-block" min="2" max="6" id="range_pl_columns">
        </div>
        <div class="my-3">
          <a class="text-decoration-none" href="javascript:" onclick="javascript: window.chrome.webview.postMessage('pos_save')"><i class="bi bi-floppy"></i> Save this position and window state</a>
        </div>
        <div class="my-3">
          <a class="text-decoration-none" href="javascript:" onclick="javascript: window.chrome.webview.postMessage('pos_reset')"><i class="bi bi-arrow-clockwise"></i> Reset position and window state to default</a>
        </div>
        <p class="fst-italics mt-3">
          <i class="bi bi-lightbulb"></i> you can use Home key to <a class="text-decoration-none" href="javascript:" onclick="javascript: window.scrollTo(0, 0)"><i class="bi bi-arrow-up-circle-fill"></i> navigate to top</a>
        </p>
      </div>

    </div>
    <footer class="mb-5">
      <div class="row">
        <hr class="w-75" />
        <p class="small">A fun project for personal use only. Source code is available at <a href="https://github.com/drive-files/yt-app" target="_blank">https://github.com/drive-files/yt-app</a></p>
      </div>
    </footer>
    <div class="toast-container position-fixed top-0 start-0 p-3">
      <div id="toast" class="toast">
        <div class="toast-header">
          <strong class="me-auto">Play Time</strong>
        </div>
        <div class="toast-body">
          Play time including the cueued video is <span id="play_time"></span>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  <script type="text/javascript">
    window.onload = documentLoaded;
  </script>
</body>
</html>

